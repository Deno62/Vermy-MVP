import { useState } from "react";
import { immobilienRepo } from "@/repositories/immobilienRepo";

export default function QuickActions() {
  const [busy, setBusy] = useState(false);

  async function addHaus() {
    try {
      setBusy(true);
      await immobilienRepo.create({ bezeichnung: "Haus (schnell)", typ: "Haus", status: "frei" });
      alert("Haus angelegt. Seite kurz neu laden oder zur Immobilien-Seite wechseln.");
    } finally {
      setBusy(false);
    }
  }

  async function addWohnung() {
    try {
      setBusy=true;
      const haeuser = await immobilienRepo.list({ typ: "Haus", parentId: null });
      if (!haeuser.length) return alert("Kein Haus vorhanden. Bitte erst ein Haus anlegen.");
      const hausId = haeuser[0].id;
      await immobilienRepo.create({ bezeichnung: "Wohnung (schnell)", typ: "Wohnung", status: "frei", parent_id: hausId });
      alert("Wohnung angelegt und dem ersten Haus zugeordnet.");
    } finally {
      setBusy(false);
    }
  }

  return (
    <div className="flex gap-2 p-2">
      <button className="px-3 py-1 rounded bg-black text-white disabled:opacity-50" disabled={busy} onClick={addHaus}>
        + Haus (schnell)
      </button>
      <button className="px-3 py-1 rounded bg-black text-white disabled:opacity-50" disabled={busy} onClick={addWohnung}>
        + Wohnung (schnell)
      </button>
    </div>
  );
}
